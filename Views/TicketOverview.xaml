<UserControl x:Class="UI.Views.TicketOverview"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:UI.Views"
			 xmlns:CustomControls="clr-namespace:UI.CustomControls"
             mc:Ignorable="d"
			 d:DesignHeight="450" d:DesignWidth="800">

	<Grid Background="White" MinWidth="650">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="50"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<Label Grid.Row="0" Content="Overview Tickets" HorizontalAlignment="Left" FontSize="48" Width="363"/>

		<StackPanel Grid.Row="1" Orientation="Horizontal">
			<ComboBox x:Name="filterType" HorizontalAlignment="Left" Width="125" Margin="0,0,15,0" SelectedIndex="0" VerticalContentAlignment="Center" FontSize="16" VerticalAlignment="Center" Height="35">
				<ComboBoxItem Content="Title"/>
				<ComboBoxItem Content="Status"/>
				<ComboBoxItem Content="Assigned to"/>
				<ComboBoxItem Content="Priority"/>
				<ComboBoxItem Content="AND (&amp;) OR (|)"/>
				<ComboBoxItem Content="Full search"/>
			</ComboBox>

			<Border BorderBrush="Black" BorderThickness="1" CornerRadius="4" Background="White" Width="250" Height="35" Margin="0,0,5,0">
				<TextBox x:Name="tbFilterInput" Text="{Binding SearchQuery, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap" FontSize="22" BorderThickness="0" Background="{x:Null}"/>
			</Border>

			<Border BorderBrush="Black" BorderThickness="1" CornerRadius="50" Width="25" Height="25" Background="White">
				<Border.ToolTip>
					<ToolTip ToolTipService.InitialShowDelay="0" ToolTipService.ShowDuration="10000">
						<StackPanel>
							<TextBlock Text="Search Tips for using the 'Full search':" FontWeight="Bold" Margin="0,0,0,5" />
							<TextBlock Text="• Full search will search the database and not just the current loaded tickets" TextWrapping="Wrap" Margin="0,2,0,0" />
							<TextBlock Text="• Use 'AND' or '&amp;' to find results that include all terms." TextWrapping="Wrap" Margin="0,2,0,0" />
							<TextBlock Text="• Use 'OR' or '|' to find results that include any of the terms." TextWrapping="Wrap" Margin="0,2,0,0" />
							<TextBlock Text="• Use '-' to exclude terms (e.g., 'login -error')." TextWrapping="Wrap" Margin="0,2,0,0" />
						</StackPanel>
					</ToolTip>
				</Border.ToolTip>

				<Label Content="!" FontSize="16" HorizontalContentAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center" VerticalContentAlignment="Center" Padding="0,0,0,0" />
			</Border>
			<Border BorderBrush="Black" BorderThickness="1" CornerRadius="7" Background="#FF159BD4" Width="175" HorizontalAlignment="Right" Margin="150,5,0,5">
				<Button x:Name="CreateTicketbtn" Content="CREATE TICKET" Command="{Binding CreateTicketCommand}" FontSize="14" Padding="0,0,0,0" BorderThickness="0" Background="{x:Null}" Foreground="White"/>
			</Border>
		</StackPanel>

		<DataGrid ItemsSource="{Binding Tickets}" Grid.Row="2" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True">
			<DataGrid.Columns>
				<DataGridTextColumn Header="Title" Binding="{Binding Title}"/>
				<DataGridTextColumn Header="Status" Binding="{Binding Status}"/>
				<DataGridTextColumn Header="Priority" Binding="{Binding Priority}"/>
				<!-- <DataGridTextColumn Header="Reported by" Binding="{Binding Reported_by.Name}"/> -->
				<DataGridTextColumn Header="Assigned to" Binding="{Binding AssigneesNames}"/>
				<!-- <DataGridTextColumn Header="Occurred at" Binding="{Binding Occurred_at}"/> -->
				<DataGridTextColumn Header="Created at" Binding="{Binding Created_at}"/>

				<DataGridTemplateColumn Header="Actions">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal">
								<Button Content="View Details" Command="{Binding DataContext.OpenTicketDetailsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Margin="0,0,5,0" />
								<Button Content="Close" Command="{Binding DataContext.CloseTicketCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
							</StackPanel>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
			</DataGrid.Columns>
		</DataGrid>

		<CustomControls:Pagination 
			VerticalAlignment="Bottom" Margin="10" Grid.Row="4"
			ChangeItemsPerPageCommand="{Binding ChangeItemsPerPageCommand}"
			ItemsPerPage="{Binding RequestParameters.ItemsPerPage}"
            PageNumber="{Binding RequestParameters.PageNumber}"
            NextPageCommand="{Binding NextPageCommand}"
            PreviousPageCommand="{Binding PreviousPageCommand}" />
	</Grid>
</UserControl>