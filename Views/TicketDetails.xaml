<UserControl x:Class="UI.Views.TicketDetails"
		xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
		xmlns:local="clr-namespace:UI.Views"
		xmlns:CustomControls="clr-namespace:UI.CustomControls"
		mc:Ignorable="d" 
		d:DesignHeight="450" d:DesignWidth="800">

	<Grid Background="White">
		<Grid.RowDefinitions>
			<!-- 0: Title -->
			<RowDefinition Height="Auto" />
			<!-- 1: Gap -->
			<RowDefinition Height="10" />
			<!-- 2: Devider -->
			<RowDefinition Height="Auto" />
			<!-- 3: Gap -->
			<RowDefinition Height="10" />
			<!-- 4: Description -->
			<RowDefinition Height="Auto" />
			<!-- 5: Gap -->
			<RowDefinition Height="10" />
			<!-- 6: Devider -->
			<RowDefinition Height="Auto" />
			<!-- 7: Gap -->
			<RowDefinition Height="10" />
			<!-- 8: Comments -->
			<RowDefinition Height="*" />
			<!-- 9: Gap -->
			<RowDefinition Height="10" />
			<!-- 10: Pagination -->
			<RowDefinition Height="Auto" />
		</Grid.RowDefinitions>
		<Grid.ColumnDefinitions>
			<!-- 0: Main -->
			<ColumnDefinition Width="70*"/>
			<!-- 1: Gap -->
			<ColumnDefinition Width="30"/>
			<!-- 12: Extras -->
			<ColumnDefinition Width="30*"/>
		</Grid.ColumnDefinitions>

		<TextBlock Grid.Row="0" Text="{Binding Ticket.Title}" FontSize="20" FontWeight="Bold" HorizontalAlignment="Left" />

		<StackPanel Grid.Row="0" Grid.Column="4" Orientation="Horizontal" HorizontalAlignment="Right">
			<Button Content="Edit" Command="{Binding EditCommand}" HorizontalAlignment="Right" Margin="0,0,15,0"/>
			<Button Content="Close" Command="{Binding CancelCommand}" HorizontalAlignment="Right"/>
		</StackPanel>

		<Separator Grid.Row="2" Grid.ColumnSpan="3"/>

		<StackPanel Grid.Row="4">
			<TextBlock Text="Description" FontSize="16" Margin="0,0,0,10" FontWeight="Bold"/>
			<TextBlock Text="{Binding Ticket.Description}" TextWrapping="Wrap" FontSize="14"/>
		</StackPanel>

		<StackPanel Grid.Row="4" Grid.Column="2" Grid.RowSpan="5">
			<TextBlock FontSize="16" Margin="0,0,0,10">
				<Run Text="Status: " FontWeight="Bold"/>
				<Run Text="{Binding Ticket.Status}" />
			</TextBlock>

			<TextBlock FontSize="16" Margin="0,0,0,10">
				<Run Text="Priority: " FontWeight="Bold"/>
				<Run Text="{Binding Ticket.Priority}" />
			</TextBlock>

			<TextBlock FontSize="16" Margin="0,0,0,10">
				<Run Text="Created at: " FontWeight="Bold"/>
				<Run Text="{Binding Ticket.Created_at}" />
			</TextBlock>

			<TextBlock FontSize="16" Margin="0,0,0,10">
				<Run Text="Reported by: " FontWeight="Bold"/>
				<Run Text="{Binding Ticket.Reported_by.Name}" />
			</TextBlock>

			<StackPanel Orientation="Horizontal">
				<TextBlock FontSize="16" Margin="0,0,0,10" VerticalAlignment="Top" HorizontalAlignment="Left">
					<Run Text="Assigned to: " FontWeight="Bold"/>
				</TextBlock>

				<TextBlock FontSize="16" Margin="5,0,0,10" VerticalAlignment="Top" HorizontalAlignment="Left">
					<ItemsControl ItemsSource="{Binding Ticket.Assigned_to}">
						<ItemsControl.ItemTemplate>
							<DataTemplate>
								<TextBlock Text="{Binding Name}"/>
							</DataTemplate>
						</ItemsControl.ItemTemplate>
					</ItemsControl>
				</TextBlock>
			</StackPanel>

			<TextBlock FontSize="16" Margin="0,0,0,10">
				<Run Text="Closed By: " FontWeight="Bold"/>
				<Run Text="{Binding Ticket.Resolved_by.Name}" />
				<TextBlock.Style>
					<Style TargetType="TextBlock">
						<Setter Property="Visibility" Value="Collapsed"/>
						<Style.Triggers>
							<DataTrigger Binding="{Binding Ticket.Status}" Value="Closed">
								<Setter Property="Visibility" Value="Visible"/>
							</DataTrigger>
						</Style.Triggers>
					</Style>
				</TextBlock.Style>
			</TextBlock>

			<TextBlock FontSize="16" Margin="0,0,0,10">
				<Run Text="Resolved By: " FontWeight="Bold"/>
				<Run Text="{Binding Ticket.Resolved_by.Name}" />
				<TextBlock.Style>
					<Style TargetType="TextBlock">
						<Setter Property="Visibility" Value="Collapsed"/>
						<Style.Triggers>
							<DataTrigger Binding="{Binding Ticket.Status}" Value="Resolved">
								<Setter Property="Visibility" Value="Visible"/>
							</DataTrigger>
						</Style.Triggers>
					</Style>
				</TextBlock.Style>
			</TextBlock>
		</StackPanel>

		<Separator Grid.Row="6"/>

		<Grid Grid.Row="8" Margin="0,10,0,10">
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="*"/>
			</Grid.RowDefinitions>

			<TextBlock Text="Comments" FontWeight="Bold" FontSize="16" Margin="0,0,0,5"/>

			<ListBox Grid.Row="1" ItemsSource="{Binding Ticket.Comments}" BorderThickness="0" BorderBrush="Gray" ScrollViewer.CanContentScroll="False">
				<ListBox.ItemTemplate>
					<DataTemplate>
						<Border BorderThickness="1" BorderBrush="LightGray" CornerRadius="5" Margin="0,5,0,5" Padding="10">
							<StackPanel>
								<TextBlock Text="{Binding Content}" FontSize="14" TextWrapping="Wrap"/>
								<StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
									<TextBlock Text="{Binding Created_at, StringFormat='{}{0:dd/MM/yyyy HH:mm}'}"
											   FontStyle="Italic" FontSize="12"
											   Foreground="Gray"
											   Margin="0,0,5,0"/>
									<TextBlock Text="{Binding Author.Name}"
											   FontStyle="Italic"
											   FontSize="12"
											   Foreground="Gray"/>
								</StackPanel>
							</StackPanel>
						</Border>
					</DataTemplate>
				</ListBox.ItemTemplate>
			</ListBox>
		</Grid>

		<StackPanel Grid.Row="10" Orientation="Horizontal" HorizontalAlignment="Stretch" Margin="0,0,0,0">
			<TextBox Width="400" Text="{Binding Comment, UpdateSourceTrigger=PropertyChanged}" Height="30" Margin="0,0,10,0" VerticalAlignment="Center"/>
			<Button Content="Submit" Command="{Binding AddCommentCommand}" Width="100" Height="30" VerticalAlignment="Center"/>
		</StackPanel>
	</Grid>
</UserControl>